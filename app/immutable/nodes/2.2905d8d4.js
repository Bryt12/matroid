import{s as Q,f as h,l as G,a as F,g as p,h as m,m as J,d as c,c as L,y as ge,j as g,i as O,v as f,D as be,E as ye,n as R,F as $e,o as W,p as Ee,k as M,w as H,G as ke}from"../chunks/scheduler.021173b9.js";import{S as X,i as Y,g as me,t as w,c as _e,a as I,b as Z,d as x,m as ee,e as te}from"../chunks/index.4c635041.js";import"../chunks/paths.da5254e3.js";import{P as Ve}from"../chunks/P5Renderer.70209d06.js";import{g as De,a as Ie}from"../chunks/nostr.c5066fa2.js";function he(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}function we(o,e={}){const{threshold:s=.1,root:n=null,rootMargin:t="0px"}=e||{};let r=!1;function l(a){a.forEach(_=>{_.isIntersecting!==r&&(r=_.isIntersecting,o.dispatchEvent(new CustomEvent("visible",{detail:{inView:r}})))})}const i=new IntersectionObserver(l,{threshold:s,root:n,rootMargin:t});return i.observe(o),{destroy(){i.disconnect()}}}function Ae(o){let e;return{c(){e=h("div"),this.h()},l(s){e=p(s,"DIV",{style:!0}),m(e).forEach(c),this.h()},h(){M(e,"width","400px"),M(e,"height","400px"),M(e,"background-color","#f0f0f0"),M(e,"border-radius","10px")},m(s,n){O(s,e,n)},p:H,i:H,o:H,d(s){s&&c(e)}}}function Pe(o){let e,s;return e=new Ve({props:{title:o[0].title,sketch:o[0].sketch,width:400,height:400,seed:o[4]}}),{c(){Z(e.$$.fragment)},l(n){x(e.$$.fragment,n)},m(n,t){ee(e,n,t),s=!0},p(n,t){const r={};t&1&&(r.title=n[0].title),t&1&&(r.sketch=n[0].sketch),t&16&&(r.seed=n[4]),e.$set(r)},i(n){s||(I(e.$$.fragment,n),s=!0)},o(n){w(e.$$.fragment,n),s=!1},d(n){te(e,n)}}}function Se(o){let e,s,n,t,r=o[0].title+"",l,i,a,_,A,v,P,$,E,b,y,j,S,k,ne="Î¾",q,C,K,T,V,z,se;const le=[Pe,Ae],D=[];function oe(u,d){return u[1]?0:1}return b=oe(o),y=D[b]=le[b](o),{c(){e=h("div"),s=h("div"),n=h("div"),t=h("span"),l=G(r),i=F(),a=h("a"),_=h("span"),A=G(o[5]),P=F(),$=h("div"),E=h("div"),y.c(),j=F(),S=h("div"),k=h("button"),k.textContent=ne,q=F(),C=h("div"),K=h("span"),T=G(o[3]),this.h()},l(u){e=p(u,"DIV",{class:!0});var d=m(e);s=p(d,"DIV",{class:!0});var N=m(s);n=p(N,"DIV",{class:!0});var B=m(n);t=p(B,"SPAN",{class:!0});var re=m(t);l=J(re,r),re.forEach(c),i=L(B),a=p(B,"A",{href:!0});var ae=m(a);_=p(ae,"SPAN",{});var ie=m(_);A=J(ie,o[5]),ie.forEach(c),ae.forEach(c),B.forEach(c),N.forEach(c),P=L(d),$=p(d,"DIV",{class:!0});var U=m($);E=p(U,"DIV",{});var ce=m(E);y.l(ce),ce.forEach(c),j=L(U),S=p(U,"DIV",{class:!0});var fe=m(S);k=p(fe,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(k)!=="svelte-1d7bezd"&&(k.textContent=ne),fe.forEach(c),U.forEach(c),q=L(d),C=p(d,"DIV",{class:!0});var ue=m(C);K=p(ue,"SPAN",{});var de=m(K);T=J(de,o[3]),de.forEach(c),ue.forEach(c),d.forEach(c),this.h()},h(){g(t,"class","title svelte-13ypc5f"),g(a,"href",v=`/profile/${o[0].publicKey}`),g(n,"class","header-text svelte-13ypc5f"),g(s,"class","header"),g(k,"class","random-button svelte-13ypc5f"),g(S,"class","random-button-container svelte-13ypc5f"),g($,"class","post-section svelte-13ypc5f"),g(C,"class","footer svelte-13ypc5f"),g(e,"class","post svelte-13ypc5f")},m(u,d){O(u,e,d),f(e,s),f(s,n),f(n,t),f(t,l),f(n,i),f(n,a),f(a,_),f(_,A),f(e,P),f(e,$),f($,E),D[b].m(E,null),o[7](E),f($,j),f($,S),f(S,k),f(e,q),f(e,C),f(C,K),f(K,T),V=!0,z||(se=[be(we.call(null,E,{threshold:0})),ye(k,"click",o[6])],z=!0)},p(u,[d]){(!V||d&1)&&r!==(r=u[0].title+"")&&R(l,r),(!V||d&32)&&R(A,u[5]),(!V||d&1&&v!==(v=`/profile/${u[0].publicKey}`))&&g(a,"href",v);let N=b;b=oe(u),b===N?D[b].p(u,d):(me(),w(D[N],1,1,()=>{D[N]=null}),_e(),y=D[b],y?y.p(u,d):(y=D[b]=le[b](u),y.c()),I(y,1),y.m(E,null)),(!V||d&8)&&R(T,u[3])},i(u){V||(I(y),V=!0)},o(u){w(y),V=!1},d(u){u&&c(e),D[b].d(),o[7](null),z=!1,$e(se)}}}function Ce(o,e,s){let n,{post:t}=e,r=!1,l,i,a=t.seeds[0];function _(){s(4,a=Math.floor(Math.random()*1e5))}W(()=>{const v=P=>{console.log("Visible event triggered!",t.title,P.detail),s(1,r=P.detail.inView)};return l.addEventListener("visible",v),()=>{l.removeEventListener("visible",v)}});function A(v){Ee[v?"unshift":"push"](()=>{l=v,s(2,l)})}return o.$$set=v=>{"post"in v&&s(0,t=v.post)},o.$$.update=()=>{if(o.$$.dirty&1&&t&&t.createdAt){let v=new Date(t.createdAt*1e3);s(3,i=v.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}))}o.$$.dirty&1&&s(5,n=t.author&&t.author.name?t.author.name:t.publicKey)},[t,r,l,i,a,n,_,A]}class Ne extends X{constructor(e){super(),Y(this,e,Ce,Se,Q,{post:0})}}function Me(o){let e,s,n;return s=new Ne({props:{post:o[0]}}),{c(){e=h("div"),Z(s.$$.fragment),this.h()},l(t){e=p(t,"DIV",{class:!0,style:!0});var r=m(e);x(s.$$.fragment,r),r.forEach(c),this.h()},h(){g(e,"class","post svelte-fc6pac"),M(e,"--bg-color",o[0].color)},m(t,r){O(t,e,r),ee(s,e,null),n=!0},p(t,[r]){const l={};r&1&&(l.post=t[0]),s.$set(l),(!n||r&1)&&M(e,"--bg-color",t[0].color)},i(t){n||(I(s.$$.fragment,t),n=!0)},o(t){w(s.$$.fragment,t),n=!1},d(t){t&&c(e),te(s)}}}function Ke(o,e){for(let s of o)if(s[0]===e)return s[1];return""}function Fe(o,e,s){let{event:n}=e;W(async()=>{s(0,r.author=await De(n.pubkey),r)}),console.log("e",n);let r={...JSON.parse(n.content),publicKey:n.pubkey,color:Ke(n.tags,"c"),createdAt:n.created_at};return o.$$set=l=>{"event"in l&&s(1,n=l.event)},[r,n]}class Le extends X{constructor(e){super(),Y(this,e,Fe,Me,Q,{event:1})}}function pe(o,e,s){const n=o.slice();return n[1]=e[s],n}function ve(o){let e,s,n,t;return s=new Le({props:{event:o[1]}}),{c(){e=h("div"),Z(s.$$.fragment),n=F()},l(r){e=p(r,"DIV",{});var l=m(e);x(s.$$.fragment,l),n=L(l),l.forEach(c)},m(r,l){O(r,e,l),ee(s,e,null),f(e,n),t=!0},p(r,l){const i={};l&1&&(i.event=r[1]),s.$set(i)},i(r){t||(I(s.$$.fragment,r),t=!0)},o(r){w(s.$$.fragment,r),t=!1},d(r){r&&c(e),te(s)}}}function Oe(o){let e,s,n=he(o[0]),t=[];for(let l=0;l<n.length;l+=1)t[l]=ve(pe(o,n,l));const r=l=>w(t[l],1,1,()=>{t[l]=null});return{c(){e=h("div");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=p(l,"DIV",{id:!0,class:!0});var i=m(e);for(let a=0;a<t.length;a+=1)t[a].l(i);i.forEach(c),this.h()},h(){g(e,"id","feed-page-content"),g(e,"class","svelte-1kmi7ht")},m(l,i){O(l,e,i);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null);s=!0},p(l,[i]){if(i&1){n=he(l[0]);let a;for(a=0;a<n.length;a+=1){const _=pe(l,n,a);t[a]?(t[a].p(_,i),I(t[a],1)):(t[a]=ve(_),t[a].c(),I(t[a],1),t[a].m(e,null))}for(me(),a=n.length;a<t.length;a+=1)r(a);_e()}},i(l){if(!s){for(let i=0;i<n.length;i+=1)I(t[i]);s=!0}},o(l){t=t.filter(Boolean);for(let i=0;i<t.length;i+=1)w(t[i]);s=!1},d(l){l&&c(e),ke(t,l)}}}function Te(o,e,s){let n=[];return W(async()=>{s(0,n=await Ie())}),[n]}class Ge extends X{constructor(e){super(),Y(this,e,Te,Oe,Q,{})}}export{Ge as component};
