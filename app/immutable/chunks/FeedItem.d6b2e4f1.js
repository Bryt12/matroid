import{s as J,f as g,a as L,g as v,h as _,c as C,d as m,j as b,i as R,v as h,o as ne,l as O,m as T,n as H,k as x}from"./scheduler.d64e95b5.js";import{S as U,i as z,b as K,d as N,m as B,a as P,t as A,e as M,g as se,c as ae}from"./index.63c1aa50.js";import{B as ee,P as oe}from"./Button.ba545a21.js";import{l as le,a as re,b as ie}from"./nostr.11a57b54.js";function Se(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function ue(s){var f;let n,a,t,e,o;return a=new ee({props:{symbol:"ξ",pillLabel:"Seed",pillValue:String(s[1]),onClick:s[3]}}),e=new ee({props:{symbol:"♥",pillLabel:"Likes",pillValue:String((f=s[0])==null?void 0:f.likes),onClick:s[4],selectColor:"#f54284",active:s[2],disabled:s[0].likeEvent===void 0}}),{c(){n=g("div"),K(a.$$.fragment),t=L(),K(e.$$.fragment),this.h()},l(r){n=v(r,"DIV",{class:!0});var l=_(n);N(a.$$.fragment,l),t=C(l),N(e.$$.fragment,l),l.forEach(m),this.h()},h(){b(n,"class","button-container svelte-drm4fo")},m(r,l){R(r,n,l),B(a,n,null),h(n,t),B(e,n,null),o=!0},p(r,[l]){var p;const i={};l&2&&(i.pillValue=String(r[1])),a.$set(i);const u={};l&1&&(u.pillValue=String((p=r[0])==null?void 0:p.likes)),l&4&&(u.active=r[2]),l&1&&(u.disabled=r[0].likeEvent===void 0),e.$set(u)},i(r){o||(P(a.$$.fragment,r),P(e.$$.fragment,r),o=!0)},o(r){A(a.$$.fragment,r),A(e.$$.fragment,r),o=!1},d(r){r&&m(n),M(a),M(e)}}}function ce(s,n,a){let t,{changeSeed:e}=n,{post:o}=n,{seed:f}=n,r;ne(async()=>{try{a(6,r=await window.nostr.getPublicKey())}catch{console.log("No nostr plugin found")}});function l(){e(Math.floor(Math.random()*1e5))}function i(){le(o.publicKey,o.id)}return s.$$set=u=>{"changeSeed"in u&&a(5,e=u.changeSeed),"post"in u&&a(0,o=u.post),"seed"in u&&a(1,f=u.seed)},s.$$.update=()=>{var u;s.$$.dirty&65&&a(2,t=(u=o==null?void 0:o.likeEvent)==null?void 0:u.some(p=>p.pubkey===r))},[o,f,t,l,i,e,r]}class fe extends U{constructor(n){super(),z(this,n,ce,ue,J,{changeSeed:5,post:0,seed:1})}}function de(s){let n,a,t,e,o=s[0].title+"",f,r,l,i,u,p,D,k,y,q,S,G,V,I,F,$;return y=new oe({props:{title:s[0].title,sketch:s[0].sketch,width:400,height:400,seed:s[2]}}),S=new fe({props:{changeSeed:s[4],post:s[0],seed:s[2]}}),{c(){n=g("div"),a=g("div"),t=g("div"),e=g("span"),f=O(o),r=L(),l=g("a"),i=g("span"),u=O(s[3]),D=L(),k=g("div"),K(y.$$.fragment),q=L(),K(S.$$.fragment),G=L(),V=g("div"),I=g("span"),F=O(s[1]),this.h()},l(c){n=v(c,"DIV",{class:!0});var d=_(n);a=v(d,"DIV",{class:!0});var w=_(a);t=v(w,"DIV",{class:!0});var E=_(t);e=v(E,"SPAN",{class:!0});var Q=_(e);f=T(Q,o),Q.forEach(m),r=C(E),l=v(E,"A",{href:!0,class:!0});var W=_(l);i=v(W,"SPAN",{});var X=_(i);u=T(X,s[3]),X.forEach(m),W.forEach(m),E.forEach(m),w.forEach(m),D=C(d),k=v(d,"DIV",{class:!0});var j=_(k);N(y.$$.fragment,j),q=C(j),N(S.$$.fragment,j),j.forEach(m),G=C(d),V=v(d,"DIV",{class:!0});var Y=_(V);I=v(Y,"SPAN",{});var Z=_(I);F=T(Z,s[1]),Z.forEach(m),Y.forEach(m),d.forEach(m),this.h()},h(){b(e,"class","title svelte-5nkysu"),b(l,"href",p=`/profile/${s[0].publicKey}`),b(l,"class","username svelte-5nkysu"),b(t,"class","header-text svelte-5nkysu"),b(a,"class","header"),b(k,"class","post-section svelte-5nkysu"),b(V,"class","footer svelte-5nkysu"),b(n,"class","post svelte-5nkysu")},m(c,d){R(c,n,d),h(n,a),h(a,t),h(t,e),h(e,f),h(t,r),h(t,l),h(l,i),h(i,u),h(n,D),h(n,k),B(y,k,null),h(k,q),B(S,k,null),h(n,G),h(n,V),h(V,I),h(I,F),$=!0},p(c,[d]){(!$||d&1)&&o!==(o=c[0].title+"")&&H(f,o),(!$||d&8)&&H(u,c[3]),(!$||d&1&&p!==(p=`/profile/${c[0].publicKey}`))&&b(l,"href",p);const w={};d&1&&(w.title=c[0].title),d&1&&(w.sketch=c[0].sketch),d&4&&(w.seed=c[2]),y.$set(w);const E={};d&1&&(E.post=c[0]),d&4&&(E.seed=c[2]),S.$set(E),(!$||d&2)&&H(F,c[1])},i(c){$||(P(y.$$.fragment,c),P(S.$$.fragment,c),$=!0)},o(c){A(y.$$.fragment,c),A(S.$$.fragment,c),$=!1},d(c){c&&m(n),M(y),M(S)}}}function he(s,n,a){let t,{post:e}=n,o,f=e==null?void 0:e.seeds[0];function r(l){a(2,f=l)}return s.$$set=l=>{"post"in l&&a(0,e=l.post)},s.$$.update=()=>{var l;if(s.$$.dirty&1&&e!=null&&e.createdAt){let i=new Date(e.createdAt*1e3);a(1,o=i.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}))}s.$$.dirty&1&&a(3,t=((l=e==null?void 0:e.author)==null?void 0:l.name)||e.publicKey)},[e,o,f,t,r]}class me extends U{constructor(n){super(),z(this,n,he,de,J,{post:0})}}function pe(s,n){for(const a of s)if(a[0]===n)return a[1];return""}function te(s){let n,a;return n=new me({props:{post:s[0]}}),{c(){K(n.$$.fragment)},l(t){N(n.$$.fragment,t)},m(t,e){B(n,t,e),a=!0},p(t,e){const o={};e&1&&(o.post=t[0]),n.$set(o)},i(t){a||(P(n.$$.fragment,t),a=!0)},o(t){A(n.$$.fragment,t),a=!1},d(t){M(n,t)}}}function ge(s){let n,a,t=s[0]&&te(s);return{c(){n=g("div"),t&&t.c(),this.h()},l(e){n=v(e,"DIV",{class:!0,style:!0});var o=_(n);t&&t.l(o),o.forEach(m),this.h()},h(){var e;b(n,"class","post svelte-fc6pac"),x(n,"--bg-color",(e=s[0])==null?void 0:e.color)},m(e,o){R(e,n,o),t&&t.m(n,null),a=!0},p(e,[o]){var f;e[0]?t?(t.p(e,o),o&1&&P(t,1)):(t=te(e),t.c(),P(t,1),t.m(n,null)):t&&(se(),A(t,1,1,()=>{t=null}),ae()),(!a||o&1)&&x(n,"--bg-color",(f=e[0])==null?void 0:f.color)},i(e){a||(P(t),a=!0)},o(e){A(t),a=!1},d(e){e&&m(n),t&&t.d()}}}function ve(s,n,a){let{event:t}=n,e;ne(async()=>{try{o()}catch(i){console.error(i)}});async function o(){f();const[i,u]=await Promise.all([re(t.pubkey),ie(t.id)]);r(i),l(u)}function f(){let i=JSON.parse(t.content);a(0,e={id:t.id,...i,publicKey:t.pubkey,color:pe(t.tags,"c"),createdAt:t.created_at})}function r(i){a(0,e.author=i,e)}function l(i){let u=0;const p=new Set;i.forEach(D=>{p.has(D.pubkey)||(u++,p.add(D.pubkey))}),a(0,e.likes=u,e),a(0,e.likeEvent=i,e)}return s.$$set=i=>{"event"in i&&a(1,t=i.event)},[e,t]}class $e extends U{constructor(n){super(),z(this,n,ve,ge,J,{event:1})}}export{$e as F,Se as e};
